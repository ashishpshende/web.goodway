"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6530],{7149:(N,g,i)=>{i.d(g,{$:()=>R});var v=i(5861),I=i(5619),s=i(3637),c=i(9212),h=i(8378),S=i(7346),U=i(5514);let R=(()=>{var E;class L{constructor(d,m,l){var n=this;this.localStorage=d,this.platform=m,this.networkService=l,this.authenticationState=new I.X(!1),this.getAuthenticationStatus=function(){var D=(0,v.Z)(function*(u){n.localStorage.getItem(s.K.LOGGED_IN_STATUS).then(p=>{console.log("AuthenticationStatus: ",p.value),u(p.value)})});return function(u){return D.apply(this,arguments)}}(),this.authenticationStatus=!1,this.platform.ready().then(()=>{this.checkToken()})}login(d){this.localStorage.setItem(s.K.LOGGED_IN_STATUS,!0).then(m=>{this.authenticationState.next(!0),this.authenticationStatus=!0,d()})}logout(d){this.localStorage.setItem(s.K.LOGGED_IN_STATUS,!1).then(m=>{this.authenticationState.next(!1),this.authenticationStatus=!1,this.localStorage.clear(),d()})}isAuthenticated(d,m){return this.localStorage.getItem(s.K.LOGGED_IN_STATUS).then(l=>{l.value?(this.authenticationState.next(!0),this.authenticationStatus=!0,d(!0)):(this.authenticationState.next(!1),this.authenticationStatus=!1,m(!1))}),this.authenticationState.value}checkToken(){this.isAuthenticated(d=>{this.authenticationStatus=d},()=>{this.authenticationStatus=!1})}}return(E=L).\u0275fac=function(d){return new(d||E)(c.LFG(h.n),c.LFG(S.t4),c.LFG(U.S))},E.\u0275prov=c.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),L})()},6709:(N,g,i)=>{i.d(g,{I:()=>I});var v=i(9212);let I=(()=>{var s;class c{constructor(){}hash(S){var U="";for(let R=0;R<S.length;R++)U+=S[R].charCodeAt(0).toString(16)+"-";return U.substring(0,U.length-1)}}return(s=c).\u0275fac=function(S){return new(S||s)},s.\u0275prov=v.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),c})()},3929:(N,g,i)=>{i.d(g,{F:()=>I});var v=i(9212);let I=(()=>{var s;class c{constructor(){this.currencySymbol="$"}}return(s=c).\u0275fac=function(S){return new(S||s)},s.\u0275prov=v.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),c})()},6530:(N,g,i)=>{i.d(g,{K:()=>D});var l,v=i(9421),I=i(5619),s=i(553),c=i(3637),h=i(6814),S=i(9212),U=i(206),R=i(6709),E=i(7149),L=i(6422),O=i(5514),d=i(3929),m=i(8378);class n{}(l=n).USER_LOGIN_URL=s.N.apiURL+"/api/users/Login",l.LIST=s.N.apiURL+"/api/users/list",l.LIST_BY_ROLE=s.N.apiURL+"/api/users/list?role=",l.LIST_ACTIVE_BY_ROLE=s.N.apiURL+"/api/users/list?status=Active&role=",l.SEARCH=s.N.apiURL+"/api/users/search",l.READ=s.N.apiURL+"/api/users/info?id=",l.UPDATE=s.N.apiURL+"/api/users/update",l.SAVE=s.N.apiURL+"/api/users/save",l.DELETE=s.N.apiURL+"/api/users/delete",l.READ_BY_USER_NAME=s.N.apiURL+"/api/users/readByEmail",l.READ_BY_EMAIL=s.N.apiURL+"/api/users/readByEmail",l.RESET_PASSWORD=s.N.apiURL+"/api/users/reset";let D=(()=>{var u;class p{constructor(e,t,r,a,o,_,A){this.eventBus=e,this.securityService=t,this.authenticationService=r,this.authorizationService=a,this.networkService=o,this.sharedService=_,this.localStorageService=A,this.genders=[],this.roles=[],this.statuses=[],this.authenticationState=new I.X(!1),this.sampleuser={Id:0,Name:"OOps, Unable to fetch User Name",Account:{Id:0,Name:"OOps, Unable to fetch Compnay Name"}},this.genders=["Male","Female","Others"],this.roles=["SuperAdmin","Admin","User"],this.statuses=["Active","InActive","Suspended"]}isSessionValid(e,t){this.localStorageService.StoredPreference.LoggedInStatus?this.loggedInUser=this.localStorageService.StoredPreference.LoggedInUser:t("SOMETHING_WENT_WRONG")}getUseDetails(e,t){!0===this.localStorageService.StoredPreference.LoggedInStatus?this.loggedInUser=this.localStorageService.StoredPreference.LoggedInUser:t("SOMETHING_WENT_WRONG")}logout(e){this.authenticationService.logout(()=>{this.loggedInUser&&(this.loggedInUser.userName="",this.loggedInUser.email="",this.loggedInUser.userRole="",this.loggedInUser.phoneNumber="",this.loggedInUser.userStatus="",this.loggedInUser.statusIcon="",e())})}login(e,t,r,a){this.loggedInUser=new v.n(JSON.parse("{}"));var o={username:e,password:this.securityService.hash(t)};this.networkService.post(n.USER_LOGIN_URL,o,_=>{if("SUCCESS"===_.statusCode)switch(this.loggedInUser=new v.n(_.data),this.loggedInUser.userStatus){case"Active":!0===this.loggedInUser.resetRequired?a("RESET_REQUIRED"):this.authenticationService.login(()=>{this.setLocalUser(this.loggedInUser),r()});break;case"Inactive":case"InActive":a("INACTIVE_USER");break;case"Suspended":a("SUSPENDED_USER")}else a("INVALID_CREDENTAILS")},()=>{a("INVALID_CREDENTAILS")})}checkUser(e,t,r,a){this.loggedInUser=new v.n(JSON.parse("{}")),this.networkService.get(n.READ_BY_USER_NAME.replace("EMAIL",e).replace("PASSWORD",this.securityService.hash(t)),o=>{if(0!==o.results.length){var _=o.results[0];switch(_.userStatus){case"Active":r(_);break;case"Inactive":case"InActive":a("INACTIVE_USER");break;case"Suspended":a("SUSPENDED_USER")}}else a("INVALID_CREDENTAILS")},()=>{a("INVALID_CREDENTAILS")})}Validate(e){return!(e.name||null==e.email||void 0===e.email||""===e.email||null==e.phoneNumber||void 0===e.phoneNumber||""===e.phoneNumber||null==e.userName||void 0===e.userName||""===e.userName)}list(e=0,t=10,r,a){this.networkService.get(n.LIST,o=>{r(o)},()=>{a()})}listbyRole(e,t,r=0,a=10,o,_){this.networkService.get((t?n.LIST_ACTIVE_BY_ROLE:n.LIST_BY_ROLE)+e,A=>{o(A)},()=>{_()})}listBykeyword(e,t=0,r=10,a,o){this.networkService.get(n.LIST,_=>{a(_)},()=>{o()})}search(e,t,r){this.networkService.get(n.SEARCH.replace("{REG_NO}",e),a=>{t(a)},()=>{r()})}read(e,t,r){this.networkService.get(n.SEARCH.replace("{REG_NO}",e),a=>{t(a.results)},()=>{r()})}readById(e,t,r){this.networkService.get(n.READ,a=>{t(a.data)},()=>{r()})}readByEmail(e,t,r){this.networkService.get(n.READ.replace("EMAIL",e),a=>{t(a.result)},()=>{r()})}readByUserName(e,t,r){this.networkService.get(n.READ_BY_USER_NAME.replace("USER_NAME",e),a=>{t(a.result)},()=>{r()})}SaveUser(e,t,r){e.createdOn=(0,h.p6)(new Date,"dd-MM-yyyy hh:mm:ss","en-US","+0530"),e.updatedOn=(0,h.p6)(new Date,"dd-MM-yyyy hh:mm:ss","en-US","+0530"),this.networkService.post(n.SAVE,this.ToJSON(e),a=>{e.id=a.id,t(e)},()=>{r()})}UpdateUser(e,t,r){e.createdOn=(0,h.p6)(new Date,"dd-MM-yyyy hh:mm:ss","en-US","+0530"),this.networkService.put(n.UPDATE.replace("{ROW_INDEX}",e.id.toString()),this.ToUpdateJSON(e),a=>{t(a)},()=>{r()})}UpdateUserCredentials(e,t,r){e.createdOn=(0,h.p6)(new Date,"dd-MM-yyyy hh:mm:ss","en-US","+0530"),this.networkService.put(n.UPDATE.replace("{ROW_INDEX}",e.id.toString()),this.ToCredentialsJSON(e),a=>{t(a)},()=>{r()})}ResetPassword(e,t,r,a){var o={UpdatedOn:(0,h.p6)(new Date,"dd-MM-yyyy hh:mm:ss","en-US","+0530"),Password:this.securityService.hash(t),ResetRequired:0};this.networkService.put(n.RESET_PASSWORD.replace("{ROW_INDEX}",e.toString()),o,_=>{r(_)},()=>{a()})}DeleteUser(e,t,r){this.networkService.delete(n.DELETE.replace("{ROW_INDEX}",e.id.toString()),this.ToJSON(e),a=>{t(a)},()=>{r()})}UpdateUserProfile(e,t,r){e.createdOn=(0,h.p6)(new Date,"dd-MM-yyyy hh:mm:ss","en-US","+0530"),this.networkService.put(n.UPDATE.replace("{ROW_INDEX}",e.id.toString()),this.ToUpdateJSON(e),a=>{console.log("UpdateUserProfile",a),this.setLocalUser(a),t(a)},()=>{r()})}setLocalUser(e){this.authorizationService.loggedInUser=e,this.localStorageService.StoredPreference.LoggedInUser=e,this.localStorageService.StoredPreference.LoggedInStatus=!0,this.localStorageService.StoredPreference.LoggedInUserEmail=e.email,this.localStorageService.StoredPreference.LoggedInUserName=e.userName,this.localStorageService.StoredPreference.LoggedInUserId=e.id,this.localStorageService.setItem(c.K.USER_OBJECT,JSON.stringify(e.ToJSON())),this.localStorageService.setItem(c.K.USER_EMAIL,e.email),this.localStorageService.setItem(c.K.USER_NAME,e.userName),this.localStorageService.setItem(c.K.USER_ROW_INDEX,e.id),this.localStorageService.setItem(c.K.DEFAULT_APP_LANGUAGE,"en"),this.localStorageService.setItem(c.K.SELECTED_APP_LANGUAGE,"en")}ToJSON(e){var t,r;return null!=e.id&&void 0!==e.id&&0!==e.id?{UserName:e.userName,Password:this.securityService.hash(null!==(t=e.password)&&void 0!==t?t:""),Email:e.email,PhoneNumber:e.phoneNumber,name:e.name,Role:e.userRole,Status:e.userStatus,Id:e.id,CreatedOn:e.createdOn,UpdatedOn:e.updatedOn,ResetRequired:e.resetRequired?1:0}:{UserName:e.userName,Password:this.securityService.hash(null!==(r=e.password)&&void 0!==r?r:""),Email:e.email,PhoneNumber:e.phoneNumber,Role:e.userRole,Status:e.userStatus,CreatedOn:e.createdOn,UpdatedOn:e.updatedOn,ResetRequired:e.resetRequired?1:0}}getUserByUserNameEmail(e,t,r,a){this.networkService.get(n.READ_BY_USER_NAME.replace("USER_NAME",e).replace("EMAIL",t).replace("USER_NAME",e),o=>{r(o)},()=>{a()})}getUserByEmail(e,t,r){this.networkService.get(n.READ_BY_EMAIL.replace("EMAIL",e),a=>{t(a)},()=>{r()})}sendForgotPasswordEmail(e,t,r,a,o,_){this.networkService.get(n.RESET_PASSWORD.replace("{USER_NAME}",t).replace("{EMAIL}",r).replace("{PASSWORD}",a).replace("{USER_FULL_NAME}",e),A=>{o(A)},()=>{_()})}sendForgotUserEmail(e,t,r,a,o){var _=n.READ.replace("{USER_NAME}",r).replace("{EMAIL}",t).replace("{USER_FULL_NAME}",e);this.networkService.get(_,A=>{a(A)},()=>{o()})}ToUpdateJSON(e){return{userName:e.userName,email:e.email,phoneNumber:e.phoneNumber,navigator:e.name,userRole:e.userRole,userStatus:e.userStatus,updatedOn:e.updatedOn}}ToProfileJSON(e){var t;return{userName:e.userName,password:this.securityService.hash(null!==(t=e.password)&&void 0!==t?t:""),email:e.email,phoneNumber:e.phoneNumber,name:e.name,id:e.id}}ToCredentialsJSON(e){var t;return e.updatedOn=(0,h.p6)(new Date,"dd-MM-yyyy hh:mm:ss","en-US","+0530"),{UserName:e.userName,Email:e.email,Password:this.securityService.hash(null!==(t=e.password)&&void 0!==t?t:""),ResetRequired:1,UpdatedOn:e.updatedOn}}}return(u=p).\u0275fac=function(e){return new(e||u)(S.LFG(U.F),S.LFG(R.I),S.LFG(E.$),S.LFG(L.Z),S.LFG(O.S),S.LFG(d.F),S.LFG(m.n))},u.\u0275prov=S.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),p})()}}]);